# 1. (CGCL)ã€ŠCandidate-aware Graph Contrastive Learning for Recommendationã€‹

> title: Candidate-aware Graph Contrastive Learning for Recommendation
>
> published: SIGIR '23
>
> paper: https://github.com/WeiHeCnSH/CGCL-Pytorch-master/blob/main/Candidate-aware%20Graph%20Contrastive%20Learning%20for%20Recommendation.pdf
>
> code: https://github.com/WeiHeCnSH/CGCL-Pytorch-master
>
> keywordsï¼šæŽ¨èç³»ç»Ÿã€å›¾å¯¹æ¯”å­¦ä¹ 
>
> æ³¨ï¼šæœ¬æ–‡æ–¹æ³•å‚è€ƒNCLæ–¹æ³•

## èƒŒæ™¯

- å¤§éƒ¨åˆ†åŸºäºŽGCLçš„æ–¹æ³•éƒ½ä½¿ç”¨å¯å‘å¼çš„æ•°æ®å¢žå¼ºæ–¹æ³•ï¼Œå¦‚éšæœºèŠ‚ç‚¹ã€è¾¹åˆ é™¤ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´é‡è¦ä¿¡æ¯çš„ä¸¢å¤±ã€‚å¹¶ä¸”ä½¿ç”¨å¯å‘å¼çš„ç­–ç•¥å¹¶ä¸é€šç”¨ï¼Œéœ€è¦æ ¹æ®å…·ä½“ä»»åŠ¡äººå·¥æŒ‘é€‰é€‚åˆçš„æ–¹æ³•ã€‚
- çŽ°æœ‰åŸºäºŽGCLçš„æ–¹æ³•å¿½ç•¥ç”¨æˆ·å’Œå€™é€‰å•†å“åœ¨ä¸åŒå±‚åµŒå…¥è¡¨å¾çš„å…³ç³»ã€‚
  - ![image-20231123152434970](../img/image-20231123152434970.png)

## åˆ›æ–°ç‚¹

è·¨å±‚è·¨sideå¯¹æ¯”

- ä¸éœ€è¦é¢å¤–æ•°æ®å¢žå¼ºæ–¹æ³•ï¼Œåªä½¿ç”¨ç”¨æˆ·å’Œå€™é€‰å•†å“åœ¨ä¸åŒå±‚çš„åµŒå…¥è¡¨å¾æ¥æž„å»ºå¯¹æ¯”è§†å›¾
- é€‰å–äº†ä¸‰ç§å¯¹æ¯”è§†å›¾æ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºåŸºäºŽç»“æž„é‚»å±…å¯¹æ¯”ï¼ˆè‡ªèº«å’ŒäºŒé˜¶é‚»å±…å¯¹æ¯”ï¼‰ã€åŸºäºŽå€™é€‰å¯¹æ¯”ï¼ˆè‡ªèº«å’Œäº¤äº’èŠ‚ç‚¹çš„ä¸€èŠ‚é‚»å±…å¯¹æ¯”ï¼‰å’ŒåŸºäºŽå€™é€‰ç»“æž„é‚»å±…å¯¹æ¯”ï¼ˆè‡ªèº«çš„äºŒé˜¶é‚»å±…å’Œäº¤äº’èŠ‚ç‚¹çš„ä¸€èŠ‚é‚»å±…å¯¹æ¯”ï¼‰ï¼Œä»Žè€Œè®¾è®¡äº†ä¸‰ä¸ªä¸åŒçš„å¯¹æ¯”æŸå¤±å‡½æ•°æ¥èŽ·å–é«˜è´¨é‡èŠ‚ç‚¹è¡¨å¾

## æ–¹æ³•

![image-20231123164437532](../img/image-20231123164437532.png)

**å‡è®¾**ï¼šåœ¨ç”¨æˆ·-å•†å“äº¤äº’å›¾ä¸­ï¼Œæ¯ä¸€å±‚çš„é‚»å±…èŠ‚ç‚¹ä¿¡æ¯éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸”è¿™äº›åŒæž„ç”¨æˆ·(å•†å“)èŠ‚ç‚¹é€šè¿‡å·ç§¯ä¼ æ’­è¿žæŽ¥èµ·æ¥ã€‚åŒæž„èŠ‚ç‚¹å¯ä»¥è¢«è®¤ä¸ºå…·æœ‰ç›¸ä¼¼çš„è¯­ä¹‰ä¿¡æ¯ï¼Œåœ¨åµŒå…¥ç©ºé—´ä¸­å½¼æ­¤ä¼šæ›´æŽ¥è¿‘ã€‚

> ä»¥ä¸‹è®ºæ–‡ç»™çš„å…¬å¼ã€ä»£ç å’Œè®ºæ–‡é‡Œçš„é˜è¿°å¹¶ä¸ä¸€æ ·ã€‚ç¬”è€…æŒ‰ç…§è‡ªå·±å¯¹ä½œè€…çš„æ„å›¾è¿›è¡Œå…¬å¼ä¸Šçš„ä¿®æ”¹ã€‚
>
> ç¬”è€…åªå¯¹ç”¨æˆ·ä¾§çš„å…¬å¼è¿›è¡Œé˜è¿°ï¼Œå•†å“ä¾§çš„å…¬å¼åŒç†å¯å¾—åˆ°ã€‚

**part A**

- å»ºæ¨¡ç»“æž„é‚»å±…å’Œä¸­å¿ƒèŠ‚ç‚¹çš„å…³ç³»

  - ä»¥ä¸­å¿ƒèŠ‚ç‚¹è‡ªèº«çš„åµŒå…¥ä¸ºé”šç‚¹ï¼Œä¸­å¿ƒèŠ‚ç‚¹çš„åŒæž„é‚»å±…èŠ‚ç‚¹åµŒå…¥ä¸ºæ­£ä¾‹ï¼Œå…¶ä»–ä¸­å¿ƒèŠ‚ç‚¹çš„åŒæž„é‚»å±…èŠ‚ç‚¹åµŒå…¥ä¸ºè´Ÿä¾‹ã€‚

  - $$
    \mathcal{L}_S^U=\sum_{u\in\mathcal{U}}-\log\frac{\exp\left(sim\left(e_u^{(0)},e_u^{(2)}\right)/\tau\right)}{\sum_{v\in\mathcal{U}}\exp\left(sim\left(e_u^{(0)},e_v^{(2)}\right)/\tau\right)}.
    $$

  - å…¶ä¸­ $e_u^{(k)}$ è¡¨ç¤ºç”¨æˆ·ç¬¬ $ k$ å±‚GNNå¾—åˆ°çš„åµŒå…¥è¡¨å¾ã€‚$\mathcal U$ ä¸ºå…¨éƒ¨çš„ç”¨æˆ·èŠ‚ç‚¹ã€‚

**part B**

- å»ºæ¨¡ç”¨æˆ·å’Œå€™é€‰å•†å“çš„å…³ç³»

  - å¦‚æžœç”¨æˆ·$u$ä¸Žå€™é€‰å•†å“$i$çš„äº¤äº’ï¼Œåˆ™è¯¥ç”¨æˆ·åº”ä¸ŽåµŒå…¥ç©ºé—´ä¸­å€™é€‰å•†å“çš„åŽ†å²äº¤äº’ç”¨æˆ·ç›¸ä¼¼ã€‚æ­¤å¤–ï¼Œç”¨æˆ·ð‘¢ä¸åº”ä¸ŽåµŒå…¥ç©ºé—´ä¸­å…¶ä»–å•†å“çš„åŽ†å²äº¤äº’ç”¨æˆ·ç›¸ä¼¼ã€‚

  - ä»¥ç”¨æˆ· $u$ çš„åµŒå…¥ä¸ºé”šç‚¹ï¼Œå€™é€‰å•†å“ $i$ ï¼ˆä¸Ž $u$ äº¤äº’çš„å•†å“ï¼‰ä¸€é˜¶é‚»å±…èŠ‚ç‚¹åµŒå…¥ä¸ºæ­£ä¾‹ï¼Œå…¶ä»–å•†å“çš„ä¸€é˜¶é‚»å±…èŠ‚ç‚¹åµŒå…¥ä¸ºè´Ÿä¾‹ã€‚

  - 
    $$
    \mathcal{L}_C^U=\sum_{u\in\mathcal{U}}-\log\frac{\sum_{i \in \mathcal I^+} \exp\left(sim\left(e_u^{(0)},e_i^{(1)}\right)/\tau\right)}{\sum_{j\in\mathcal{I}}\exp\left(sim\left(e_u^{(0)},e_j^{(1)}\right)/\tau\right)}.
    $$

  - å…¶ä¸­ $e_u^{(k)}$ è¡¨ç¤ºç”¨æˆ·ç¬¬ $ k$ å±‚GNNå¾—åˆ°çš„åµŒå…¥è¡¨å¾ã€‚$\mathcal U$ ä¸ºå…¨éƒ¨çš„ç”¨æˆ·èŠ‚ç‚¹ã€‚$\mathcal I$ å’Œ $\mathcal I^+$ åˆ†åˆ«è¡¨ç¤ºä¸ºå…¨éƒ¨å•†å“èŠ‚ç‚¹å’Œä¸Žç”¨æˆ· $u$ äº¤äº’çš„å•†å“èŠ‚ç‚¹ã€‚

**part C**

- å»ºæ¨¡ç”¨æˆ·çš„ç»“æž„é‚»å±…å’Œå€™é€‰å•†å“çš„å…³ç³»

  - å¦‚æžœç”¨æˆ·$u$ä¸Žå€™é€‰å•†å“$i$äº¤äº’ï¼Œåˆ™è¯¥ç”¨æˆ·äºŒé˜¶é‚»å±…èŠ‚ç‚¹åº”ä¸ŽåµŒå…¥ç©ºé—´ä¸­å€™é€‰å•†å“çš„ä¸€é˜¶é‚»å±…ç”¨æˆ·ç›¸ä¼¼ã€‚æ­¤å¤–ï¼Œç”¨æˆ·ð‘¢ä¸åº”ä¸ŽåµŒå…¥ç©ºé—´ä¸­å…¶ä»–å•†å“çš„åŽ†å²äº¤äº’ç”¨æˆ·ç›¸ä¼¼ã€‚

  - ä»¥ç”¨æˆ· $u$ çš„äºŒé˜¶é‚»å±…èŠ‚ç‚¹åµŒå…¥ä¸ºé”šç‚¹ï¼Œå€™é€‰å•†å“ $i$ ï¼ˆä¸Ž $u$ äº¤äº’çš„å•†å“ï¼‰ä¸€é˜¶é‚»å±…èŠ‚ç‚¹åµŒå…¥ä¸ºæ­£ä¾‹ï¼Œå…¶ä»–å•†å“çš„ä¸€é˜¶é‚»å±…èŠ‚ç‚¹åµŒå…¥ä¸ºè´Ÿä¾‹ã€‚

  - 
    $$
    \mathcal{L}_{CS}^U=\sum_{u\in\mathcal{U}}-\log\frac{\sum_{i \in \mathcal I^+} \exp\left(sim\left(e_u^{(2)},e_i^{(1)}\right)/\tau\right)}{\sum_{j\in\mathcal{I}}\exp\left(sim\left(e_u^{(2)},e_j^{(1)}\right)/\tau\right)}.
    $$

  - å…¶ä¸­ $e_u^{(k)}$ è¡¨ç¤ºç”¨æˆ·ç¬¬ $ k$ å±‚GNNå¾—åˆ°çš„åµŒå…¥è¡¨å¾ã€‚$\mathcal U$ ä¸ºå…¨éƒ¨çš„ç”¨æˆ·èŠ‚ç‚¹ã€‚$\mathcal I$ å’Œ $\mathcal I^+$ åˆ†åˆ«è¡¨ç¤ºä¸ºå…¨éƒ¨å•†å“èŠ‚ç‚¹å’Œä¸Žç”¨æˆ· $u$ äº¤äº’çš„å•†å“èŠ‚ç‚¹ã€‚

**ä¼˜åŒ–**
$$
\mathcal{L}_{CGCL}=\mathcal{L}_{Rec}+\lambda_{1}\mathcal{L}_{S}+\lambda_{2}\mathcal{L}_{C}+\lambda_{3}\mathcal{L}_{CS}+\lambda_{4}\left\|\Theta\right\|_{2}^{2}.
$$

## æ€è€ƒ

è®ºæ–‡é˜è¿°æ€æƒ³å’Œåˆ—ä¸¾çš„å…¬å¼**ä¸ç¬¦**

- ä½œè€…åˆ©ç”¨ä¸åŒå±‚å’Œä¸åŒsideç»„åˆæž„é€ å¯¹æ¯”è§†å›¾ï¼Œå…·æœ‰ä¸€å®šåˆ›æ–°æ€§ã€‚ä½†æ˜¯è¿™ç§ç»„åˆçš„æƒå€¼æ˜¯ç”±äººå·¥ç¡®å®šçš„ï¼Œèƒ½å¦è€ƒè™‘ä½¿ç”¨è‡ªé€‚åº”æ–¹æ³•è‡ªåŠ¨å­¦ä¹ å¾—åˆ°ã€‚ä½œè€…åªè€ƒè™‘ä¸‰ç§ç»„åˆæ–¹å¼ï¼Œèƒ½å¦æ·»åŠ å…¶ä»–åˆç†çš„ç»„åˆæ–¹å¼ã€‚
- ç»“åˆå…¬å¼å’Œä»£ç ï¼Œå¯ä»¥ç¡®å®šä½œè€…ä½¿ç”¨çš„æ˜¯å…¨éƒ¨èŠ‚ç‚¹æž„é€ è´Ÿä¾‹ï¼Œè®¡ç®—ä»£ä»·æ¯”è¾ƒå¤§
- æ ¹æ®æ¶ˆèžå®žéªŒå¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨Aæ–¹æ³•è´¡çŒ®æ˜¯æœ€å¤§çš„ï¼Œå³é’ˆå¯¹åŒä¸€èŠ‚ç‚¹çš„ä¸åŒå±‚åµŒå…¥è¿›è¡Œå¯¹æ¯”å­¦ä¹ ã€‚å‰©ä¸‹ä¸¤ç§æ–¹æ³•è´¡çŒ®è¾ƒå°‘ã€‚
- æ ¹æ®ä»£ç ç»™çš„è¶…å‚æ•°å€¼ï¼Œå‘çŽ°åœ¨è”åˆä¼˜åŒ–æŸå¤±å‡½æ•°ä¸­ï¼Œä¸‰ä¸ªå¯¹æ¯”æŸå¤±å‡½æ•°çš„æƒé‡éƒ½æ¯”è¾ƒå°ï¼Œåˆ†åˆ«ä¸º1e-5, 1e-5, 1e-6ã€‚



# 2.ï¼ˆNCLï¼‰ã€ŠImproving graph collaborative filtering with neighborhood-enriched contrastive learningã€‹

> title: Improving graph collaborative filtering with neighborhood-enriched contrastive learning
>
> published: WWW '22
>
> paper: https://arxiv.org/pdf/2202.06200.pdf
>
> code: https://github.com/RUCAIBox/NCL
>
> keywordsï¼šæŽ¨èç³»ç»Ÿã€ååŒè¿‡æ»¤ã€å›¾å¯¹æ¯”å­¦ä¹ 

## ä¸»è¦å†…å®¹

ä¸ºäº†æž„é€ æ›´æœ‰æ„ä¹‰çš„é¢å‘æŽ¨èé¢†åŸŸçš„å¯¹æ¯”è§†å›¾ï¼Œä½œè€…è€ƒè™‘äº†ç”¨æˆ·å•†å“äº¤äº’å›¾ä¸­èŠ‚ç‚¹çš„é‚»å±…å…³ç³»ä¿¡æ¯â€”â€”ç»“æž„é‚»å±…ä¿¡æ¯å’Œè¯­ä¹‰é‚»å±…ä¿¡æ¯ï¼Œç„¶åŽå°†èŠ‚ç‚¹å’Œå…¶åŒæž„é‚»å±…æž„æˆå¯¹æ¯”å…³ç³»ï¼Œå°†èŠ‚ç‚¹å’Œé€šè¿‡èšç±»åŽçš„èšç±»ä¸­å¿ƒæž„æˆå¯¹æ¯”å…³ç³»ï¼Œè®¾è®¡äº†ä¸¤ç§å¯¹åº”çš„å¯¹æ¯”å­¦ä¹ æŸå¤±å‡½æ•°è¿›è¡Œä¼˜åŒ–å­¦ä¹ ã€‚å…¶ä¸­ï¼ŒåŸºäºŽè¯­ä¹‰çš„å¯¹æ¯”å­¦ä¹ ä¸­èšç±»è¿‡ç¨‹æ— æ³•è¿›è¡Œç«¯åˆ°ç«¯ä¼˜åŒ–ï¼Œå› æ­¤ä½¿ç”¨EMç®—æ³•è¿›è¡Œä¼˜åŒ–å­¦ä¹ ã€‚

## èƒŒæ™¯

åˆ©ç”¨ç”¨æˆ·äº¤äº’åŽ†å²ä¿¡æ¯æž„å»ºçš„äºŒéƒ¨å›¾ï¼ŒèŠ‚ç‚¹å…³ç³»å¯ä»¥åˆ†ä¸ºå››ç§ï¼š1. ç›¸ä¼¼ç”¨æˆ·ï¼›2. ç›¸ä¼¼ç‰©å“ï¼›3. ç”¨æˆ·-ç‰©å“äº¤äº’å…³ç³»ï¼›4. å…·æœ‰ç›¸ä¼¼è¯­ä¹‰å…³ç³»ï¼ˆä¾‹å¦‚ç”¨æˆ·æ„å›¾ç­‰ï¼‰ã€‚å¤§å¤šæ•°æŽ¨èä»»åŠ¡å›´ç»•ç”¨æˆ·-ç‰©å“äº¤äº’å…³ç³»å±•å¼€ï¼Œè€Œå¯¹åŒæž„èŠ‚ç‚¹ä¹‹é—´çš„ç»“æž„å…³ç³»è€ƒè™‘è¾ƒå°‘ï¼Œå¯¹è¯­ä¹‰å…³ç³»è€ƒè™‘çš„æ›´å°‘ã€‚

- çŽ°æœ‰çš„å¯¹æ¯”å­¦ä¹ æ–¹æ³•
  - æ¬ ç¼ºè€ƒè™‘ï¼šå¦‚ä½•æž„å»ºæ›´åŠ æœ‰æ„ä¹‰çš„é€‚ç”¨æŽ¨èä»»åŠ¡çš„å¯¹æ¯”å­¦ä¹ ä»»åŠ¡
  - å¿½ç•¥äº†ç”¨æˆ·ï¼ˆå•†å“ï¼‰ä¹‹é—´çš„é‚»å±…å…³ç³»ä¿¡æ¯
- æƒ³æ³•
  - ä»ŽèŠ‚ç‚¹çº§åˆ«çš„å…³ç³»è€ƒè™‘ï¼Œåˆ©ç”¨å•†å“äº¤äº’å›¾ä¸­æœ‰ç”¨çš„å…³ç³»ä¿¡æ¯æ¥è®¾è®¡æ›´åŠ æœ‰æ•ˆçš„å¯¹æ¯”æ–¹æ³•
    - ç»“æž„é‚»å±…ï¼šé€šè¿‡é«˜é˜¶è·¯å¾„åœ¨å›¾ç»“æž„ä¸Šè¿žæŽ¥çš„èŠ‚ç‚¹
    - è¯­ä¹‰é‚»å±…ï¼šå›¾ä¸Šæ— æ³•åˆ°è¾¾ä½†å…·æœ‰ç›¸ä¼¼ç‰¹å¾ï¼ˆå•†å“èŠ‚ç‚¹ï¼‰æˆ–åå¥½ï¼ˆç”¨æˆ·èŠ‚ç‚¹ï¼‰çš„èŠ‚ç‚¹
  - å¯¹äºŽç»“æž„é‚»å±…ï¼ŒæŠŠGNNç¬¬kå±‚è¾“å‡ºä½œä¸ºèŠ‚ç‚¹ç¬¬kè·³é‚»å±…çš„è¡¨ç¤º
    - GNNç¬¬kå±‚è¾“å‡ºæ±‡èšäº†kè·³é‚»å±…ä¿¡æ¯
  - å¯¹äºŽè¯­ä¹‰é‚»å±…ï¼Œåœ¨è¡¨å¾ç©ºé—´ä¸­è¯­ä¹‰ç›¸ä¼¼çš„é‚»å±…ç°‡çš„ä¸­å¿ƒ
    - è¯­ä¹‰é‚»å±…æ˜¯éšå˜é‡ï¼Œé€šè¿‡EMç®—æ³•å¾—åˆ°

- åˆ›æ–°ç‚¹
  - è€ƒè™‘ç»“æž„é‚»å±…å’Œè¯­ä¹‰é‚»å±…çš„ä¿¡æ¯æ¥æå‡å›¾ååŒè¿‡æ»¤çš„æŽ¨èæ€§èƒ½
    - èŠ‚ç‚¹å’ŒèŠ‚ç‚¹é‚»å±…æž„æˆå¯¹æ¯”å…³ç³»
    - èšç±»åŽï¼ŒèŠ‚ç‚¹ä¸Žèšç±»ä¸­å¿ƒæž„æˆå¯¹æ¯”å…³ç³»
      - ä½¿ç”¨K-meansç®—æ³•å’ŒEMç®—æ³•ä¼˜åŒ–è¯­ä¹‰é‚»å±…å¯¹æ¯”æŸå¤±
  - åªä½¿ç”¨èŠ‚ç‚¹è¡¨å¾å’Œå…¶é‚»å±…èŠ‚ç‚¹è¡¨å¾åšå¯¹æ¯”å­¦ä¹ ï¼Œæé«˜ç®—æ³•æ•ˆçŽ‡

## æ–¹æ³•

![image-20231202195249784](../img/image-20231202195249784.png)

- ä½¿ç”¨LightGCNç¼–ç ç”¨æˆ·å’Œå•†å“ä¿¡æ¯
- è®¾è®¡äº†ä¸¤ç§å¯¹æ¯”å­¦ä¹ èŒƒå¼

### ç»“æž„é‚»å±…å¯¹æ¯”å­¦ä¹ 

è€ƒè™‘åˆ°äº¤äº’å›¾æ˜¯ä¸€ä¸ªäºŒéƒ¨å›¾ï¼ŒåŸºäºŽGNNçš„æ¨¡åž‹åœ¨å›¾ä¸Šè¿›è¡Œ**å¶æ•°æ¬¡**ï¼ˆå¦‚2ï¼Œ4ï¼Œ6ï¼‰çš„ä¿¡æ¯ä¼ æ’­æ—¶ï¼Œè‡ªç„¶åœ°èšé›†äº†åŒæž„ç»“æž„é‚»å±…çš„ä¿¡æ¯ï¼Œä»¥ä¾¿äºŽæå–ç”¨æˆ·æˆ–å•†å“çš„æ½œåœ¨é‚»å±…ã€‚

- å°†æ¯ä¸ªç”¨æˆ·(æˆ–é¡¹ç›®)ä¸Žå…¶**åŒæž„ç»“æž„é‚»å±…**(å…¶è¡¨å¾é€šè¿‡GNNçš„å±‚ä¼ æ’­èšåˆè€Œå¾—)è¿›è¡Œå¯¹æ¯”

- ä»¥å¶æ•°å±‚GNNè¾“å‡ºåµŒå…¥ä¸ºé”šç‚¹ï¼Œ**å°†èŠ‚ç‚¹å¶æ•°å±‚GNNè¾“å‡ºåµŒå…¥ä¸Žå…¶è‡ªèº«çš„åµŒå…¥è§†ä¸ºæ­£ä¾‹**ï¼Œä¸Žå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹åµŒå…¥è§†ä¸ºè´Ÿä¾‹

- ä»¥ç”¨æˆ·ä¾§çš„å¯¹æ¯”æŸå¤±ä¸ºä¾‹ï¼Œå¦‚ä¸‹ï¼š
  $$
  \mathcal{L}_S^U=\sum_{u\in\mathcal{U}}-\log\frac{\exp((\mathbf{z}_u^{(k)}\cdot\mathbf{z}_u^{(0)}/\tau))}{\sum_{v\in\mathcal{U}}\exp((\mathbf{z}_u^{(k)}\cdot\mathbf{z}_v^{(0)}/\tau))},
  $$
  å…¶ä¸­ï¼Œ$z_u^{(k)}$ ä¸ºç¬¬kå±‚GNNè§„èŒƒåŒ–è¾“å‡ºï¼Œkä¸ºå¶æ•°ã€‚å•†å“ä¾§å¯¹æ¯”æŸå¤±åŒç†å¯å¾—ï¼š
  $$
  \mathcal{L}_S^I=\sum_{i\in I}-\log\frac{\exp((\mathbf{z}_i^{(k)}\cdot\mathbf{z}_i^{(0)}/\tau))}{\sum_{j\in I}\exp((\mathbf{z}_i^{(k)}\cdot\mathbf{z}_j^{(0)}/\tau))},
  $$
  æœ€ç»ˆçš„ç»“æž„å¯¹æ¯”æŸå¤±å‡½æ•°ä¸ºï¼š
  $$
  \mathcal{L}_{S}=\mathcal{L}_{S}^{U}+\alpha\mathcal{L}_{S}^{I}.
  $$

### è¯­ä¹‰é‚»å±…å¯¹æ¯”å­¦ä¹ 

> è¯¥éƒ¨åˆ†æ˜¯å‚è€ƒPCL ([Prototypical contrastive learning of unsupervised representations](https://arxiv.org/abs/2005.04966))åŸºäºŽåŽŸåž‹çš„å¯¹æ¯”æ–¹æ³•ï¼Œå¹¶ä¸”è®²çš„ä¹Ÿä¸æ¸…æ™°ï¼Œå¯¹æ­¤æˆ‘ä¼šä½¿ç”¨PCLè®ºæ–‡å†…å®¹è¡¥å……

ç»“æž„å¯¹æ¯”æŸå¤±å¹³ç­‰åœ°å¯¹å¾…ç”¨æˆ·/å•†å“çš„åŒæž„é‚»å±…ï¼Œè¿™ä¸å¯é¿å…åœ°å°†å™ªå£°ä¿¡æ¯å¼•å…¥å¯¹æ¯”å­¦ä¹ ã€‚å› æ­¤ï¼Œé€šè¿‡ç»“åˆè¯­ä¹‰é‚»å±…æ¥æ‰©å±•å¯¹æ¯”å­¦ä¹ ã€‚

- å—PGCLæ¨¡åž‹å¯å‘ï¼ˆå…¶å®žå€Ÿé‰´çš„æ˜¯CVé¢†åŸŸçš„**PCLæ¨¡åž‹**ï¼‰ï¼Œé€šè¿‡å­¦ä¹ æ¯ä¸ªç”¨æˆ·å’Œå•†å“çš„éšåŽŸåž‹ (latent prototype)è¯†åˆ«è¯­ä¹‰é‚»å±…
- ç›¸ä¼¼çš„ç”¨æˆ·/å•†å“å€¾å‘äºŽè½åœ¨åŒä¸€ä¸ªé‚»å±…åµŒå…¥ç©ºé—´ä¸­ã€‚é€šè¿‡èšç±»ï¼Œå°†ç›¸ä¼¼embeddingå¯¹åº”çš„èŠ‚ç‚¹åˆ’åˆ†çš„ç›¸åŒçš„ç°‡ï¼Œç”¨ç°‡ä¸­å¿ƒä»£è¡¨è¿™ä¸ªç°‡ï¼Œè¿™ä¸ªä¸­å¿ƒç§°ä¸ºåŽŸåž‹ (prototype)
  - ä½¿ç”¨K-meansèšç±»ç®—æ³•èŽ·å¾—ç”¨æˆ·/å•†å“çš„åŽŸåž‹

> åŸºäºŽæœŸæœ›æœ€å¤§åŒ–(EM)ç®—æ³•æž„é€ åŽŸåž‹å¯¹æ¯”å­¦ä¹ ï¼Œå…¶ç›®æ ‡æ˜¯é€šè¿‡è¿­ä»£é€¼è¿‘å’Œæœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼Œæ‰¾åˆ°æœ€èƒ½æè¿°æ•°æ®åˆ†å¸ƒçš„æ·±åº¦ç¥žç»ç½‘ç»œ(DNN)çš„å‚æ•°ã€‚
>
> æœ€å°åŒ–åŽŸåž‹å¯¹æ¯”æŸå¤±å‡½æ•°ç­‰ä»·äºŽæœ€å¤§åŒ–ä¸‹é¢çš„å¯¹æ•°ä¼¼ç„¶ä¼°è®¡å‡½æ•°ï¼Œåœ¨æ¯ä¸ªåŽŸåž‹å‘¨å›´çš„æ•°æ®åˆ†å¸ƒæ˜¯å„å‘åŒæ€§çš„é«˜æ–¯åˆ†å¸ƒçš„å‡è®¾ä¸‹ã€‚
>
> PCLçš„ç›®æ ‡æ˜¯æ‰¾åˆ°ç½‘ç»œå‚æ•° $\theta$ æœ€å¤§åŒ–nä¸ªè§‚å¯Ÿæ ·æœ¬çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š
> $$
> \theta^*=\arg\max\sum_{i=1}^n\log p(x_i;\theta)
> $$
> å‡è®¾è§‚å¯Ÿæ•°æ®æ˜¯ä¸Žéšå˜é‡ $C=\{c_i\}_{i=1}^k$ ï¼Œä¹Ÿå°±æ˜¯æ•°æ®çš„åŽŸåž‹æœ‰å…³ï¼Œåˆ™å¯ä»¥é‡å†™ä¸ºå¦‚ä¸‹ï¼š
> $$
> \theta^*=\arg\max_{\theta}\sum_{i=1}^n\log p(x_i;\theta)=\arg\max_{\theta}\sum_{i=1}^n\log\sum_{c_i\in C}p(x_i,c_i;\theta)
> $$

â€‹		æ¨¡åž‹ç›®æ ‡æ˜¯æœ€å¤§åŒ–ä¸‹é¢çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°(è®°ä¸ºF)ï¼š
$$
\sum_{u\in\mathcal{U}}\log p(\mathbf{e}_{\boldsymbol{u}}|\Theta,\mathbf{R})=\sum_{u\in\mathcal{U}}\log\sum_{\mathbf{c}_{i}\in C}p(\mathbf{e}_{\boldsymbol{u}},\mathbf{c}_{\boldsymbol{i}}|\Theta,\mathbf{R}),
$$
â€‹		å…¶ä¸­ï¼Œ$\theta$ ä¸ºæ¨¡åž‹å‚æ•°ï¼Œ$\bold R$ ä¸ºäº¤äº’çŸ©é˜µï¼Œ$c_i$ ä¸ºç”¨æˆ· $u$ çš„éšåŽŸåž‹ã€‚

- åŽŸåž‹å¯¹æ¯”å­¦ä¹ æŸå¤±å‡½æ•°å¦‚ä¸‹ï¼š

$$
\mathcal{L}_P^U=\sum_{u\in\mathcal{U}}-\log\frac{\exp(\mathbf{e}_u\cdot\mathbf{c}_i/\tau)}{\sum_{\mathbf{c}_j\in C}\exp(\mathbf{e}_u\cdot\mathbf{c}_j/\tau)}. \\
\mathcal{L}_P^I=\sum_{i\in I}-\log\frac{\exp(\mathbf{e}_i\cdot\mathbf{c}_j/\tau)}{\sum_{\mathbf{c}_t\in C}\exp(\mathbf{e}_i\cdot\mathbf{c}_t/\tau)}. \\
\mathcal{L}_{P}=\mathcal{L}_{P}^{U}+\alpha\mathcal{L}_{P}^{I}.
$$

â€‹		ç”±äºŽ $\mathcal L_P$ ä¸èƒ½ç«¯åˆ°ç«¯ä¼˜åŒ–ï¼Œéœ€è¦ä½¿ç”¨**EMç®—æ³•**ä¼˜åŒ–å…¶æŸå¤±ã€‚

### ä¼˜åŒ–

**æ€»ä½“ä¼˜åŒ–ç›®æ ‡å‡½æ•°**

- è”åˆä¼˜åŒ–

$$
\mathcal{L}=\mathcal{L}_{BPR}+\lambda_{1}\mathcal{L}_{S}+\lambda_{2}\mathcal{L}_{P}+\lambda_{3}||\Theta||_{2}
$$

**EMç®—æ³•ä¼˜åŒ–æŸå¤±** $\mathcal L_P$

> $$
> \begin{aligned}\sum_{i=1}^n\log\sum_{c_i\in C}p(x_i,c_i;\theta)&=\sum_{i=1}^n\log\sum_{c_i\in C}Q(c_i)\frac{p(x_i,c_i;\theta)}{Q(c_i)}\geq\sum_{i=1}^n\sum_{c_i\in C}Q(c_i)\log\frac{p(x_i,c_i;\theta)}{Q(c_i)},\end{aligned}
> $$
>
> $$
> \sum_{c_{i}\in C}Q(c_{i})=1
> $$
>
> Jensenä¸ç­‰å¼ï¼š
> $$
> \sum_{i=1}^M\lambda_if(x_i)\geq f(\sum_{i=1}^M\lambda_ix_i)
> $$
> æ³¨ï¼šæ ¹æ®Jensenä¸ç­‰å¼ï¼Œæˆ‘è®¤ä¸ºæœ€åŽä¸€æ­¥æ˜¯å°äºŽç­‰äºŽç¬¦å·ï¼Œä¼˜åŒ–å…¶ä¸Šç•Œã€‚
>
> ä¸ºäº†ä½¿ä¸ç­‰å¼å–å¾—ç­‰å·ï¼ŒæŠŠ $\frac{p(x_i,c_i;\theta)}{Q(c_i)}$ è®¾ä¸ºå¸¸é‡ï¼Œå› æ­¤æœ‰ï¼š
> $$
> Q(c_i)=\frac{p(x_i,c_i;\theta)}{\sum_{c_i\in C}p(x_i,c_i;\theta)}=\frac{p(x_i,c_i;\theta)}{p(x_i;\theta)}=p(c_i;x_i,\theta)
> $$
> å¿½ç•¥å¸¸é‡ï¼Œåˆ™æœ€å¤§åŒ–å¦‚ä¸‹ï¼š
> $$
> \begin{aligned}\sum_{i=1}^n\sum_{c_i\in C}Q(c_i)\log p(x_i,c_i;\theta)\end{aligned}
> $$

- Få‡½æ•°å¾ˆéš¾ç›´æŽ¥ä¼˜åŒ–ï¼Œä½¿ç”¨Jensenä¸ç­‰å¼èŽ·å¾—Få‡½æ•°çš„ä¸‹ç•Œ (LB)

  - $$
    LB=\sum_{u\in\mathcal{U}}\sum_{\mathbf{c}_i\in C}Q(\mathbf{c}_i|\mathbf{e}_u)\log\frac{p(\mathbf{e}_u,\mathbf{c}_i|\Theta,\mathbf{R})}{Q(\mathbf{c}_i|\mathbf{e}_u)}
    $$

  - $Q(c_i|e_u)$ ä¸ºå½“è§‚å¯Ÿ $e_u$ æ—¶éšå˜é‡ $c_i$ çš„åˆ†å¸ƒ

- E-æ­¥ï¼šé€šè¿‡èšç±»ï¼Œè¿­ä»£æ‰§è¡Œæ‰¾åˆ°åŽŸåž‹çš„åˆ†å¸ƒ

  - å›ºå®š $e_u$ ï¼Œ$Q(c_i|e_u)$ å¯ä»¥å¯¹æ‰€æœ‰ç”¨æˆ·åµŒå…¥ä½¿ç”¨K-meansèšç±»ç®—æ³•ä¼°è®¡å¾—åˆ°ã€‚
  - å¦‚æžœ $e_u \in c_i$ï¼Œåˆ™ $\hat Q(c_i|e_u)=1$ï¼Œåä¹‹ä¸º0 

> æœ€å¤§åŒ–ä¸‹å±Šå‡½æ•°ï¼š
> $$
> \begin{aligned}
> \begin{aligned}\sum_{i=1}^n\sum_{c_i\in C}Q(c_i)\log p(x_i,c_i;\theta)\end{aligned}& =\sum_{i=1}^n\sum_{c_i\in C}p(c_i;x_i,\theta)\log p(x_i,c_i;\theta)  \\
> &=\sum_{i=1}^n\sum_{c_i\in C}\mathbb{1}(x_i\in c_i)\log p(x_i,c_i;\theta)
> \end{aligned}
> $$
> åœ¨èšç±»ä¸­å¿ƒä¸ºå‡åŒ€åˆ†å¸ƒçš„å…ˆéªŒå‡è®¾ä¸‹ï¼Œæœ‰ï¼š
> $$
> p(x_i,c_i;\theta)=p(x_i;c_i,\theta)p(c_i;\theta)=\frac{1}{k}\cdot p(x_i;c_i,\theta),
> $$
> åœ¨æ¯ä¸ªåŽŸåž‹å‘¨å›´çš„åˆ†å¸ƒæ˜¯å„å‘åŒæ€§çš„é«˜æ–¯åˆ†å¸ƒçš„å‡è®¾ä¸‹ï¼Œæœ‰ï¼š
> $$
> p(x_i;c_i,\theta)=\exp\left(\frac{-(v_i-c_s)^2}{2\sigma_s^2}\right)\Big/\sum_{j=1}^k\exp\left(\frac{-(v_i-c_j)^2}{2\sigma_j^2}\right),
> $$
> å…¶ä¸­ï¼Œ$v_i=f_\theta(x_i)$ä¸” $x_i \in c_s$ã€‚

- M-æ­¥ï¼šé€šè¿‡å¯¹æ¯”å­¦ä¹ ä¼˜åŒ–ç½‘ç»œå‚æ•°

  - ä½¿ç”¨ $\hat Q(c_i|e_u)$ é‡å†™ç›®æ ‡å‡½æ•°ï¼š
    $$
    \mathcal{L}_{P}^{U}=-\sum_{u\in\mathcal{U}}\sum_{\mathbf{c}_{i}\in C}\hat{Q}(\mathbf{c}_{i}|\mathbf{e}_{u})\log p(\mathbf{e}_{u},\mathbf{c}_{i}|\Theta,\mathbf{R})
    $$

  - å‡è®¾æ‰€æœ‰ç°‡ä¸­ç”¨æˆ·åˆ†å¸ƒéƒ½æ˜¯å„å‘åŒæ€§ï¼ˆæ–¹å·®å„æ–¹å‘éƒ½ä¸€æ ·ï¼‰çš„é«˜æ–¯åˆ†å¸ƒï¼Œåˆ™åˆå¯æ”¹å†™ä¸ºï¼š
    $$
    \mathcal{L}_P^U=-\sum_{u\in\mathcal{U}}\log\frac{\exp(-(\mathbf{e}_u-\mathbf{c}_i)^2/2\sigma_i^2)}{\sum_{\mathbf{c}_j\in C}\exp(-(\mathbf{e}_u-\mathbf{c}_j)^2/2\sigma_j^2)}
    $$
    è‹¥ $e_u, c_i$ ç»è¿‡L2æ ‡å‡†åŒ–ï¼Œåˆ™ $(e_u-c_i)^2=2-2e_uc_i$ã€‚å‡è®¾æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒéƒ½æœ‰ç›¸åŒçš„æ–¹å·®ï¼Œè¿™å¯ä»¥å†™æˆæ¸©åº¦ç³»æ•° $\tau$ã€‚å› æ­¤å‡½æ•°å°±å¯ä»¥ç®€åŒ–æˆåˆšå¼€å§‹æå‡ºæ—¶çš„æ ·å­ã€‚

> $$
> \theta^*=\arg\min_{\theta}\sum_{i=1}^n-\log\frac{\exp(v_i\cdot c_s/\phi_s)}{\sum_{j=1}^k\exp(v_i\cdot c_j/\phi_j)},
> $$



## ç»“æžœ

![image-20231202195156424](../img/image-20231202195156424.png)

## æ€è€ƒ

> å­˜åœ¨çš„é—®é¢˜ï¼š
>
> è®ºæ–‡æœ‰è¿™ä¹ˆä¸€å¥è¯ï¼š However, high-order neighbor relations within users (or within items) are also valuable for recommendations. For example, users are more likely to buy the same product as their neighbors. Next, we will propose two contrastive learning objectives to capture the potential neighborhood relationships of users and items.
>
> ä½œè€…æ‰€ä¸¾çš„ä¾‹å­æ˜¯è¡¨æ˜Žï¼ŒèŠ‚ç‚¹åµŒå…¥å’Œå…¶äºŒé˜¶é‚»å±…ä¿¡æ¯åµŒå…¥æœ‰å…³ï¼Œä½†æ˜¯æ–‡ä¸­çš„å›¾ä¸€å’Œå›¾äºŒéƒ½æ˜¯æŠŠèŠ‚ç‚¹åµŒå…¥å’Œå…¶ä¸€èŠ‚é‚»å±…ä¿¡æ¯åµŒå…¥ä½œä¸ºæ­£ä¾‹ï¼Œè¿™å’Œè®ºæ–‡åŽé¢çš„æ–¹æ³•é˜è¿°ä¹Ÿä¸ä¸€æ ·ã€‚

1. k-meansèšç±»ä¸­kçš„é€‰å–æœ‰ä»€ä¹ˆå®žé™…æ„ä¹‰å—?æœ‰ä»€ä¹ˆå‚è€ƒä¾æ®å—ï¼Ÿ
   - åœ¨PCLä¸­å› ä¸ºåšåˆ†ç±»ï¼Œkæ¯”è¾ƒå°ï¼›è€Œåœ¨æœ¬æ–‡ä¸­ï¼Œkå–å€¼å¾ˆå¤§å¾ˆå¤§ã€‚
2. åŸºäºŽè¯­ä¹‰é‚»å±…çš„å¯¹æ¯”å­¦ä¹ ï¼Œé€šè¿‡å¯¹æ‰€æœ‰åµŒå…¥è¿›è¡Œèšç±»ï¼Œå¼•å…¥äº†å…¨å±€çš„è¯­ä¹‰ä¿¡æ¯



# å‚è€ƒæ–‡çŒ®

> 1. Wei He, Guohao Sun, Jinhu Lu, and Xiu Susie Fang. 2023. Candidate-aware Graph Contrastive Learning for Recommendation. In Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR '23). Association for Computing Machinery, New York, NY, USA, 1670â€“1679. https://doi.org/10.1145/3539618.3591647
> 2. Lin Z, Tian C, Hou Y, et al. Improving graph collaborative filtering with neighborhood-enriched contrastive learning[C]//Proceedings of the ACM Web Conference 2022. 2022: 2320-2329.
> 2. Yonghui Yang, Zhengwei Wu, Le Wu, Kun Zhang, Richang Hong, Zhiqiang Zhang, Jun Zhou, and Meng Wang. 2023. Generative-Contrastive Graph Learning for Recommendation. In Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR '23). Association for Computing Machinery, New York, NY, USA, 1117â€“1126. https://doi.org/10.1145/3539618.3591691

